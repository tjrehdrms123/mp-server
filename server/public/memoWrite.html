<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#Dong-geun Suk</title>
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/index.css">
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>    
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body> 
	<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=ed26c2f025fa61380c53b7965d9eaa47&libraries=clusterer"></script>
	<div class="form-group">
		<label class="col-sm-2 control-label">사진 위치 입력하기</label>
		<div class="col-sm-10 item-label">
			<input type="text" id="sample5_address" placeholder="주소">
			<input type="button" onclick="sample5_execDaumPostcode()" value="주소 검색">	
			<input type="button" onclick="myDisplay()" value="내 위치 보기">		
			<div id="map" style="width:600px;height:600px;margin-top:10px;"></div>
			<p id="result"></p>
			<script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
			<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=cefcf971e6f0b2509f6126815d7f587f&libraries=services"></script>
			<script>
				var mapContainer = document.getElementById('map'), // 지도를 표시할 div
					mapOption = {
						center: new daum.maps.LatLng(37.563109, 126.89143), // 지도의 중심좌표
						level: 5 // 지도의 확대 레벨
					};

				//지도를 미리 생성
				var map = new daum.maps.Map(mapContainer, mapOption);
				//주소-좌표 변환 객체를 생성
				var geocoder = new daum.maps.services.Geocoder();

				imageSize = new kakao.maps.Size(64, 69), // 마커이미지의 크기입니다
				imageOption = {offset: new kakao.maps.Point(27, 69)}; // 마커이미지의 옵션입니다. 마커의 좌표와 일치시킬 이미지 안에서의 좌표를 설정합니다.

				//마커를 미리 생성
				var marker = new daum.maps.Marker({
					position: new daum.maps.LatLng(37.563109, 126.89143),
					map: map,
				});
				// 검색을했을때 지도 이벤트
				function sample5_execDaumPostcode() {
					new daum.Postcode({
						oncomplete: function(data) {
							var addr = data.address; // 최종 주소 변수

							// 주소 정보를 해당 필드에 넣는다.
							document.getElementById("sample5_address").value = addr;
							// 주소로 상세 정보를 검색
							geocoder.addressSearch(data.address, function(results, status) {
								// 정상적으로 검색이 완료됐으면
								if (status === daum.maps.services.Status.OK) {

									var result = results[0]; //첫번째 결과의 값을 활용

									// 해당 주소에 대한 좌표를 받아서
									var coords = new daum.maps.LatLng(result.y, result.x);
									// 지도를 보여준다.
									mapContainer.style.display = "block";
									map.relayout();
									// 지도 중심을 변경한다.
									map.setCenter(coords);
									// 마커를 결과값으로 받은 위치로 옮긴다.
									marker.setPosition(coords)
								}
							});
						}
					}).open();
				} 
				kakao.maps.event.addListener(map, 'center_changed', function() { 
					// 지도 중심좌표를 얻어옵니다 
					var latlng = map.getCenter();   

					document.getElementById('lat').value = latlng.getLat();
					document.getElementById('lng').value = latlng.getLng();	
					
					marker.setPosition(latlng);
				});
				function myDisplay(){
					// HTML5의 geolocation으로 사용할 수 있는지 확인합니다 
					if (navigator.geolocation) {
						
						// GeoLocation을 이용해서 접속 위치를 얻어옵니다
						navigator.geolocation.getCurrentPosition(function(position) {
							
							var lat = position.coords.latitude, // 위도
								lon = position.coords.longitude; // 경도
							
							var locPosition = new kakao.maps.LatLng(lat, lon), // 마커가 표시될 위치를 geolocation으로 얻어온 좌표로 생성합니다
								message = '<div style="padding:5px;">현재의 위치</div>'; // 인포윈도우에 표시될 내용입니다
							
							// 마커와 인포윈도우를 표시합니다
							map.setCenter(locPosition);
							marker.setPosition(locPosition);
								
						});
						
					}
				}   	
			</script>			
		</div>
	</div>	
</body>
</html>